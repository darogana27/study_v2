<mxfile host="app.diagrams.net" modified="2024-01-20T00:00:00.000Z" agent="Claude" etag="xxx" version="24.0.0" type="device">
  <diagram name="PFC-Architecture" id="architecture">
    <mxGraphModel dx="1422" dy="794" grid="1" gridSize="10" guides="1" tooltips="1" connect="1" arrows="1" fold="1" page="1" pageScale="1" pageWidth="1654" pageHeight="1169" math="0" shadow="0">
      <root>
        <mxCell id="0" />
        <mxCell id="1" parent="0" />
        
        <!-- User Layer -->
        <mxCell id="user" value="🧑‍💻 ユーザー" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#e1f5fe;strokeColor=#01579b;fontStyle=1;fontSize=14;" vertex="1" parent="1">
          <mxGeometry x="40" y="40" width="120" height="60" as="geometry" />
        </mxCell>
        
        <!-- Frontend Layer -->
        <mxCell id="frontend-layer" value="フロントエンド層" style="swimlane;whiteSpace=wrap;html=1;fillColor=#f3e5f5;strokeColor=#4a148c;fontStyle=1;" vertex="1" parent="1">
          <mxGeometry x="230" y="20" width="400" height="140" as="geometry" />
        </mxCell>
        
        <mxCell id="react-app" value="React App&#xa;🎯 選択肢型UI&#xa;💬 フリー入力UI&#xa;🗺️ Leaflet Map" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#ffffff;strokeColor=#666666;" vertex="1" parent="frontend-layer">
          <mxGeometry x="20" y="30" width="120" height="80" as="geometry" />
        </mxCell>
        
        <mxCell id="cloudfront" value="☁️ CloudFront&#xa;CDN配信&#xa;PriceClass_100" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#ffffff;strokeColor=#666666;" vertex="1" parent="frontend-layer">
          <mxGeometry x="160" y="30" width="100" height="80" as="geometry" />
        </mxCell>
        
        <mxCell id="s3-bucket" value="🗂️ S3 Bucket&#xa;静的ホスティング&#xa;ライフサイクル設定" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#ffffff;strokeColor=#666666;" vertex="1" parent="frontend-layer">
          <mxGeometry x="280" y="30" width="100" height="80" as="geometry" />
        </mxCell>
        
        <!-- API Layer -->
        <mxCell id="api-layer" value="API層" style="swimlane;whiteSpace=wrap;html=1;fillColor=#fff3e0;strokeColor=#e65100;fontStyle=1;" vertex="1" parent="1">
          <mxGeometry x="700" y="20" width="500" height="140" as="geometry" />
        </mxCell>
        
        <mxCell id="api-gateway" value="🌐 API Gateway&#xa;HTTP API&#xa;CORS設定" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#ffffff;strokeColor=#666666;" vertex="1" parent="api-layer">
          <mxGeometry x="20" y="30" width="100" height="80" as="geometry" />
        </mxCell>
        
        <mxCell id="lambda-chat" value="⚡ Lambda&#xa;park-finder-chat&#xa;256MB / 30sec&#xa;🎯 選択肢処理" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#ffffff;strokeColor=#666666;" vertex="1" parent="api-layer">
          <mxGeometry x="140" y="30" width="110" height="80" as="geometry" />
        </mxCell>
        
        <mxCell id="lambda-api" value="⚡ Lambda&#xa;parking-spots-api&#xa;128MB / 30sec" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#ffffff;strokeColor=#666666;" vertex="1" parent="api-layer">
          <mxGeometry x="270" y="30" width="110" height="80" as="geometry" />
        </mxCell>
        
        <mxCell id="lambda-collector" value="⚡ Lambda&#xa;data-collector&#xa;128MB / 60sec&#xa;🕒 10分間隔" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#ffffff;strokeColor=#666666;" vertex="1" parent="api-layer">
          <mxGeometry x="400" y="30" width="110" height="80" as="geometry" />
        </mxCell>
        
        <!-- AI Layer -->
        <mxCell id="ai-layer" value="AI/ML層" style="swimlane;whiteSpace=wrap;html=1;fillColor=#e8f5e8;strokeColor=#2e7d32;fontStyle=1;" vertex="1" parent="1">
          <mxGeometry x="700" y="200" width="250" height="100" as="geometry" />
        </mxCell>
        
        <mxCell id="bedrock" value="🤖 Amazon Bedrock&#xa;Claude-3-Haiku&#xa;💰 89%コスト削減&#xa;📏 150トークン制限" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#ffffff;strokeColor=#666666;" vertex="1" parent="ai-layer">
          <mxGeometry x="20" y="30" width="200" height="60" as="geometry" />
        </mxCell>
        
        <!-- Data Layer -->
        <mxCell id="data-layer" value="データ層" style="swimlane;whiteSpace=wrap;html=1;fillColor=#f1f8e9;strokeColor=#558b2f;fontStyle=1;" vertex="1" parent="1">
          <mxGeometry x="230" y="200" width="400" height="100" as="geometry" />
        </mxCell>
        
        <mxCell id="dynamodb" value="🗄️ DynamoDB&#xa;ParkingSpots Table&#xa;Pay-per-Request&#xa;🔍 事前フィルタリング" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#ffffff;strokeColor=#666666;" vertex="1" parent="data-layer">
          <mxGeometry x="20" y="30" width="150" height="60" as="geometry" />
        </mxCell>
        
        <mxCell id="external-api" value="🌐 外部API&#xa;駐車場データ&#xa;リアルタイム更新" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#ffffff;strokeColor=#666666;" vertex="1" parent="data-layer">
          <mxGeometry x="200" y="30" width="120" height="60" as="geometry" />
        </mxCell>
        
        <!-- Schedule Layer -->
        <mxCell id="schedule-layer" value="スケジュール層" style="swimlane;whiteSpace=wrap;html=1;fillColor=#fce4ec;strokeColor=#880e4f;fontStyle=1;" vertex="1" parent="1">
          <mxGeometry x="1000" y="200" width="200" height="100" as="geometry" />
        </mxCell>
        
        <mxCell id="eventbridge" value="⏰ EventBridge&#xa;Scheduler&#xa;🔄 10分間隔実行" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#ffffff;strokeColor=#666666;" vertex="1" parent="schedule-layer">
          <mxGeometry x="20" y="30" width="150" height="60" as="geometry" />
        </mxCell>
        
        <!-- Monitoring Layer -->
        <mxCell id="monitoring-layer" value="監視・ログ層" style="swimlane;whiteSpace=wrap;html=1;fillColor=#e3f2fd;strokeColor=#1565c0;fontStyle=1;" vertex="1" parent="1">
          <mxGeometry x="1250" y="20" width="200" height="280" as="geometry" />
        </mxCell>
        
        <mxCell id="cloudwatch" value="📊 CloudWatch&#xa;Logs &amp; Metrics&#xa;💰 コスト監視&#xa;🚨 アラート設定" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#ffffff;strokeColor=#666666;" vertex="1" parent="monitoring-layer">
          <mxGeometry x="20" y="30" width="150" height="80" as="geometry" />
        </mxCell>
        
        <mxCell id="cost-optimization" value="💰 コスト最適化&#xa;月額: $3.76 (¥560)&#xa;🎯 選択肢型UI&#xa;🤖 Haiku採用&#xa;📏 トークン制限" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#c8e6c9;strokeColor=#2e7d32;" vertex="1" parent="monitoring-layer">
          <mxGeometry x="20" y="130" width="150" height="100" as="geometry" />
        </mxCell>
        
        <!-- Flow Connections -->
        <mxCell id="flow1" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;strokeWidth=2;strokeColor=#1976d2;" edge="1" parent="1" source="user" target="react-app">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        
        <mxCell id="flow2" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;strokeWidth=2;strokeColor=#1976d2;" edge="1" parent="1" source="react-app" target="cloudfront">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        
        <mxCell id="flow3" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;strokeWidth=2;strokeColor=#1976d2;" edge="1" parent="1" source="cloudfront" target="s3-bucket">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        
        <mxCell id="flow4" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;strokeWidth=2;strokeColor=#e65100;" edge="1" parent="1" source="react-app" target="api-gateway">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        
        <mxCell id="flow5" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;strokeWidth=2;strokeColor=#e65100;" edge="1" parent="1" source="api-gateway" target="lambda-chat">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        
        <mxCell id="flow6" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;strokeWidth=2;strokeColor=#e65100;" edge="1" parent="1" source="api-gateway" target="lambda-api">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        
        <mxCell id="flow7" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;strokeWidth=2;strokeColor=#2e7d32;" edge="1" parent="1" source="lambda-chat" target="bedrock">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        
        <mxCell id="flow8" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;strokeWidth=2;strokeColor=#558b2f;" edge="1" parent="1" source="lambda-chat" target="dynamodb">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        
        <mxCell id="flow9" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;strokeWidth=2;strokeColor=#558b2f;" edge="1" parent="1" source="lambda-api" target="dynamodb">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        
        <mxCell id="flow10" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;strokeWidth=2;strokeColor=#880e4f;" edge="1" parent="1" source="eventbridge" target="lambda-collector">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        
        <mxCell id="flow11" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;strokeWidth=2;strokeColor=#558b2f;" edge="1" parent="1" source="lambda-collector" target="dynamodb">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        
        <mxCell id="flow12" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;strokeWidth=2;strokeColor=#558b2f;" edge="1" parent="1" source="lambda-collector" target="external-api">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        
        <!-- Monitoring Connections -->
        <mxCell id="monitor1" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;strokeWidth=1;strokeColor=#1565c0;dashed=1;" edge="1" parent="1" source="lambda-chat" target="cloudwatch">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        
        <mxCell id="monitor2" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;strokeWidth=1;strokeColor=#1565c0;dashed=1;" edge="1" parent="1" source="lambda-api" target="cloudwatch">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        
        <mxCell id="monitor3" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;strokeWidth=1;strokeColor=#1565c0;dashed=1;" edge="1" parent="1" source="lambda-collector" target="cloudwatch">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        
        <!-- Selection Flow Process -->
        <mxCell id="selection-flow" value="🎯 選択肢型チャットフロー" style="swimlane;whiteSpace=wrap;html=1;fillColor=#e8eaf6;strokeColor=#3f51b5;fontStyle=1;" vertex="1" parent="1">
          <mxGeometry x="40" y="350" width="1200" height="200" as="geometry" />
        </mxCell>
        
        <mxCell id="step1" value="STEP 1&#xa;🏢 場所選択&#xa;🌳公園 🚉駅周辺&#xa;🛒商業施設 🏥病院" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#c8e6c9;strokeColor=#2e7d32;" vertex="1" parent="selection-flow">
          <mxGeometry x="20" y="40" width="120" height="80" as="geometry" />
        </mxCell>
        
        <mxCell id="step2" value="STEP 2&#xa;⚡ 優先条件&#xa;💰無料 💸安い&#xa;🚶駅近 🏍️バイク可" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#c8e6c9;strokeColor=#2e7d32;" vertex="1" parent="selection-flow">
          <mxGeometry x="160" y="40" width="120" height="80" as="geometry" />
        </mxCell>
        
        <mxCell id="step3" value="STEP 3&#xa;📍 エリア選択&#xa;池袋西口/東口&#xa;現在地周辺" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#c8e6c9;strokeColor=#2e7d32;" vertex="1" parent="selection-flow">
          <mxGeometry x="300" y="40" width="120" height="80" as="geometry" />
        </mxCell>
        
        <mxCell id="filter" value="🔍 フィルタリング&#xa;DynamoDB&#xa;事前絞り込み&#xa;最大10件" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#fff3e0;strokeColor=#e65100;" vertex="1" parent="selection-flow">
          <mxGeometry x="440" y="40" width="120" height="80" as="geometry" />
        </mxCell>
        
        <mxCell id="bedrock-opt" value="🤖 Bedrock最適化&#xa;超短縮プロンプト&#xa;150トークン制限&#xa;Claude-3-Haiku" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#e8f5e8;strokeColor=#2e7d32;" vertex="1" parent="selection-flow">
          <mxGeometry x="580" y="40" width="140" height="80" as="geometry" />
        </mxCell>
        
        <mxCell id="response" value="📋 応答生成&#xa;推奨駐車場3件&#xa;マップ更新&#xa;サジェスト表示" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#e1f5fe;strokeColor=#01579b;" vertex="1" parent="selection-flow">
          <mxGeometry x="740" y="40" width="120" height="80" as="geometry" />
        </mxCell>
        
        <mxCell id="cost-result" value="💰 コスト結果&#xa;月額: $1.20&#xa;(従来$10.80)&#xa;89%削減達成" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#ffcdd2;strokeColor=#d32f2f;" vertex="1" parent="selection-flow">
          <mxGeometry x="880" y="40" width="120" height="80" as="geometry" />
        </mxCell>
        
        <mxCell id="ux-benefit" value="✨ UX向上&#xa;即座レスポンス&#xa;タップ操作&#xa;モバイル最適化" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#f3e5f5;strokeColor=#4a148c;" vertex="1" parent="selection-flow">
          <mxGeometry x="1020" y="40" width="120" height="80" as="geometry" />
        </mxCell>
        
        <!-- Selection Flow Arrows -->
        <mxCell id="arrow1" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;strokeWidth=3;strokeColor=#2e7d32;" edge="1" parent="selection-flow" source="step1" target="step2">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        
        <mxCell id="arrow2" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;strokeWidth=3;strokeColor=#2e7d32;" edge="1" parent="selection-flow" source="step2" target="step3">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        
        <mxCell id="arrow3" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;strokeWidth=3;strokeColor=#e65100;" edge="1" parent="selection-flow" source="step3" target="filter">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        
        <mxCell id="arrow4" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;strokeWidth=3;strokeColor=#2e7d32;" edge="1" parent="selection-flow" source="filter" target="bedrock-opt">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        
        <mxCell id="arrow5" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;strokeWidth=3;strokeColor=#01579b;" edge="1" parent="selection-flow" source="bedrock-opt" target="response">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        
        <mxCell id="arrow6" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;strokeWidth=2;strokeColor=#d32f2f;" edge="1" parent="selection-flow" source="response" target="cost-result">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        
        <mxCell id="arrow7" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;strokeWidth=2;strokeColor=#4a148c;" edge="1" parent="selection-flow" source="response" target="ux-benefit">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        
        <!-- Title -->
        <mxCell id="title" value="PFC (Parking Finder Chat) システム構成図&#xa;選択肢型チャットによるコスト最適化アーキテクチャ" style="text;html=1;strokeColor=none;fillColor=none;align=center;verticalAlign=middle;whiteSpace=wrap;rounded=0;fontSize=16;fontStyle=1;" vertex="1" parent="1">
          <mxGeometry x="500" y="570" width="500" height="40" as="geometry" />
        </mxCell>
        
      </root>
    </mxGraphModel>
  </diagram>
</mxfile>