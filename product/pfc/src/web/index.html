<!DOCTYPE html>
<html lang="ja">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>PFC - 東京駐輪場検索</title>
    <link rel="stylesheet" href="https://unpkg.com/leaflet@1.9.4/dist/leaflet.css" />
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif;
            height: 100vh;
            overflow: hidden;
            background: #f5f5f5;
        }

        /* ヘッダー */
        .header {
            height: 60px;
            background: #2c3e50;
            color: white;
            display: flex;
            align-items: center;
            padding: 0 20px;
            box-shadow: 0 2px 4px rgba(0,0,0,0.1);
            z-index: 1000;
        }

        .logo {
            font-size: 24px;
            font-weight: bold;
        }

        .header-subtitle {
            margin-left: 20px;
            opacity: 0.8;
            font-size: 14px;
        }

        /* メインコンテナ */
        .main-container {
            display: flex;
            height: calc(100vh - 60px);
        }

        /* 左サイドバー（エリア選択タブ） */
        .left-sidebar {
            width: 300px;
            background: white;
            border-right: 1px solid #ddd;
            display: flex;
            flex-direction: column;
            overflow: hidden;
        }

        .sidebar-header {
            padding: 20px;
            background: #34495e;
            color: white;
        }

        .sidebar-title {
            font-size: 18px;
            margin-bottom: 5px;
        }

        .sidebar-subtitle {
            font-size: 12px;
            opacity: 0.8;
        }

        .area-tabs {
            flex: 1;
            overflow-y: auto;
        }

        .tab-group {
            border-bottom: 1px solid #eee;
        }

        .tab-group-header {
            background: #ecf0f1;
            padding: 12px 20px;
            font-weight: 600;
            color: #2c3e50;
            font-size: 14px;
            cursor: pointer;
            user-select: none;
        }

        .tab-group-header:hover {
            background: #d5dbdb;
        }

        .tab-items {
            display: none;
        }

        .tab-items.active {
            display: block;
        }

        .tab-item {
            padding: 12px 20px;
            cursor: pointer;
            border-bottom: 1px solid #f8f9fa;
            transition: all 0.2s ease;
        }

        .tab-item:hover {
            background: #f8f9fa;
            padding-left: 25px;
        }

        .tab-item.selected {
            background: #3498db;
            color: white;
        }

        .tab-item.selected:hover {
            background: #2980b9;
        }

        /* 中央マップエリア */
        .map-container {
            flex: 1;
            position: relative;
        }

        .main-container.chat-collapsed .map-container {
            width: 100%;
            margin-right: 0;
        }

        #map {
            width: 100%;
            height: 100%;
        }

        .map-controls {
            position: absolute;
            top: 20px;
            left: 20px;
            z-index: 1000;
            background: white;
            padding: 10px;
            border-radius: 8px;
            box-shadow: 0 2px 10px rgba(0,0,0,0.1);
        }

        .current-area {
            font-weight: 600;
            color: #2c3e50;
            margin-bottom: 5px;
        }

        .area-info {
            font-size: 12px;
            color: #7f8c8d;
        }

        /* 右サイドバー（チャット） */
        .right-sidebar {
            width: 400px;
            background: white;
            border-left: 1px solid #ddd;
            display: flex;
            flex-direction: column;
            position: relative;
            height: calc(100vh - 60px);
        }

        .sidebar-toggle {
            position: absolute;
            top: 50%;
            left: -15px;
            transform: translateY(-50%);
            background: #27ae60;
            color: white;
            border: none;
            width: 30px;
            height: 60px;
            border-radius: 15px 0 0 15px;
            cursor: pointer;
            font-size: 16px;
            z-index: 1001;
            transition: all 0.3s ease-in-out;
            display: flex;
            align-items: center;
            justify-content: center;
            box-shadow: 0 2px 8px rgba(0,0,0,0.15);
            padding: 0;
        }

        .sidebar-toggle:hover {
            background: #219a52;
            transform: translateY(-50%) scale(1.1);
            box-shadow: 0 4px 12px rgba(0,0,0,0.25);
        }

        .right-sidebar {
            transition: width 0.3s ease-in-out, background 0.3s ease-in-out, border 0.3s ease-in-out;
        }

        .right-sidebar.collapsed {
            width: 0;
            min-width: 0;
            overflow: visible;
            background: transparent;
            border: none;
        }

        .right-sidebar.collapsed .sidebar-toggle {
            right: 20px;
            bottom: 80px;
            left: auto;
            top: auto;
            transform: none;
            border-radius: 25px;
            width: auto;
            min-width: 120px;
            height: 50px;
            background: #3498db;
            animation: bounce 3s infinite;
            position: fixed;
            z-index: 9999;
            font-size: 14px;
            font-weight: 600;
            padding: 0 15px;
            box-shadow: 0 4px 15px rgba(52, 152, 219, 0.4);
        }

        .right-sidebar.collapsed .sidebar-toggle:hover {
            background: #2980b9;
            transform: translateY(-5px) scale(1.05);
        }

        .right-sidebar.collapsed .chat-header,
        .right-sidebar.collapsed .chat-tabs,
        .right-sidebar.collapsed .chat-messages,
        .right-sidebar.collapsed .chat-input {
            display: none;
        }

        @keyframes pulse {
            0% {
                box-shadow: 0 0 0 0 rgba(52, 152, 219, 0.7);
            }
            70% {
                box-shadow: 0 0 0 10px rgba(52, 152, 219, 0);
            }
            100% {
                box-shadow: 0 0 0 0 rgba(52, 152, 219, 0);
            }
        }

        @keyframes bounce {
            0%, 20%, 50%, 80%, 100% {
                transform: translateY(0);
            }
            40% {
                transform: translateY(-10px);
            }
            60% {
                transform: translateY(-5px);
            }
        }

        .sidebar-toggle-icon {
            transition: all 0.3s ease;
        }

        .chat-header {
            padding: 15px 20px 10px 20px;
            background: #27ae60;
            color: white;
            position: relative;
        }

        .chat-title {
            font-size: 18px;
            margin-bottom: 5px;
        }

        .chat-subtitle {
            font-size: 12px;
            opacity: 0.8;
        }

        /* チャットタブ */
        .chat-tabs {
            background: #ecf0f1;
            border-bottom: 1px solid #bdc3c7;
            display: flex;
            overflow-x: auto;
            padding: 0 20px;
        }

        .chat-tab {
            padding: 10px 15px;
            cursor: pointer;
            border-radius: 8px 8px 0 0;
            margin-right: 5px;
            font-size: 12px;
            background: #bdc3c7;
            color: #2c3e50;
            white-space: nowrap;
            display: flex;
            align-items: center;
            gap: 5px;
            transition: all 0.2s ease;
        }

        .chat-tab.active {
            background: white;
            color: #27ae60;
            font-weight: 600;
        }

        .chat-tab:hover {
            background: #d5dbdb;
        }

        .chat-tab.active:hover {
            background: white;
        }

        .tab-close {
            background: rgba(231, 76, 60, 0.1);
            border: 1px solid rgba(231, 76, 60, 0.3);
            color: #e74c3c;
            cursor: pointer;
            font-weight: bold;
            padding: 0;
            margin-left: 8px;
            width: 20px;
            height: 20px;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 12px;
            transition: all 0.2s ease;
            opacity: 0.7;
        }

        .tab-close:hover {
            background: #e74c3c;
            color: white;
            opacity: 1;
            transform: scale(1.1);
            box-shadow: 0 2px 4px rgba(231, 76, 60, 0.3);
        }

        .chat-tab:hover .tab-close {
            opacity: 1;
        }

        /* タブ削除アニメーション */
        .tab-removing {
            animation: tabSlideOut 0.3s ease-out forwards;
        }

        @keyframes tabSlideOut {
            from {
                opacity: 1;
                transform: translateX(0);
                max-width: 200px;
            }
            to {
                opacity: 0;
                transform: translateX(-20px);
                max-width: 0;
                padding: 0;
                margin: 0;
            }
        }

        .new-chat-tab {
            padding: 10px 15px;
            cursor: pointer;
            color: #27ae60;
            font-size: 18px;
            font-weight: bold;
            display: flex;
            align-items: center;
            margin-left: auto;
        }

        .new-chat-tab:hover {
            background: #d5dbdb;
            border-radius: 8px;
        }

        .chat-messages {
            flex: 1;
            padding: 20px;
            overflow-y: auto;
            background: #f8f9fa;
        }

        .message {
            margin-bottom: 15px;
            animation: fadeInUp 0.3s ease;
        }

        .message.bot {
            text-align: left;
        }

        .message.user {
            text-align: right;
        }

        .message-content {
            display: inline-block;
            max-width: 80%;
            padding: 12px 16px;
            border-radius: 18px;
            box-shadow: 0 1px 3px rgba(0,0,0,0.1);
        }

        .message.bot .message-content {
            background: white;
            color: #2c3e50;
        }

        .message.user .message-content {
            background: #3498db;
            color: white;
        }

        .chat-input {
            padding: 20px;
            border-top: 1px solid #ddd;
            background: white;
        }

        .input-container {
            display: flex;
            gap: 10px;
        }

        .message-input {
            flex: 1;
            padding: 12px;
            border: 1px solid #ddd;
            border-radius: 20px;
            outline: none;
            font-size: 14px;
        }

        .message-input:focus {
            border-color: #3498db;
        }

        .send-button {
            padding: 12px 20px;
            background: #3498db;
            color: white;
            border: none;
            border-radius: 20px;
            cursor: pointer;
            font-weight: 600;
        }

        .send-button:hover {
            background: #2980b9;
        }

        /* 選択肢ボタン */
        .chat-options {
            margin-top: 10px;
            display: flex;
            flex-direction: column;
            gap: 8px;
        }

        .option-button {
            background: #f8f9fa;
            border: 1px solid #dee2e6;
            border-radius: 20px;
            padding: 10px 15px;
            cursor: pointer;
            transition: all 0.2s ease;
            text-align: left;
            font-size: 14px;
            color: #495057;
        }

        .option-button:hover {
            background: #e9ecef;
            border-color: #3498db;
            transform: translateY(-1px);
        }

        .option-button.selected {
            background: #3498db;
            color: white;
            border-color: #3498db;
        }

        /* 目的地入力フィールド */
        .destination-input {
            margin-top: 10px;
            padding: 10px;
            border: 1px solid #dee2e6;
            border-radius: 20px;
            outline: none;
            width: 100%;
            font-size: 14px;
        }

        .destination-input:focus {
            border-color: #3498db;
        }

        .confirm-button {
            margin-top: 10px;
            background: #27ae60;
            color: white;
            border: none;
            border-radius: 20px;
            padding: 10px 20px;
            cursor: pointer;
            font-size: 14px;
            transition: all 0.2s ease;
        }

        .confirm-button:hover {
            background: #219a52;
        }

        /* 駐輪場リスト（チャット内） */
        .parking-list {
            margin-top: 15px;
        }

        .parking-card {
            background: white;
            border: 1px solid #ddd;
            border-radius: 8px;
            padding: 12px;
            margin-bottom: 10px;
            cursor: pointer;
            transition: all 0.2s ease;
        }

        .parking-card:hover {
            border-color: #3498db;
            transform: translateY(-1px);
        }

        .parking-name {
            font-weight: 600;
            color: #2c3e50;
            margin-bottom: 5px;
        }

        .parking-info {
            font-size: 12px;
            color: #7f8c8d;
            display: flex;
            justify-content: space-between;
        }

        .priority-tag {
            display: inline-block;
            background: #e74c3c;
            color: white;
            font-size: 10px;
            padding: 2px 6px;
            border-radius: 10px;
            margin-left: 5px;
        }

        .priority-tag.price {
            background: #f39c12;
        }

        .priority-tag.availability {
            background: #27ae60;
        }

        .priority-tag.distance {
            background: #3498db;
        }

        /* 左下固定広告 */
        .bottom-left-ad {
            position: fixed;
            bottom: 20px;
            left: 20px;
            width: 250px;
            background: white;
            border-radius: 10px;
            box-shadow: 0 4px 12px rgba(0,0,0,0.15);
            overflow: hidden;
            z-index: 1000;
            animation: slideInLeft 0.5s ease-out;
        }

        .ad-close {
            position: absolute;
            top: 8px;
            right: 8px;
            background: rgba(0,0,0,0.5);
            color: white;
            border: none;
            width: 20px;
            height: 20px;
            border-radius: 50%;
            font-size: 14px;
            cursor: pointer;
            display: flex;
            align-items: center;
            justify-content: center;
            z-index: 1;
        }

        .ad-close:hover {
            background: rgba(0,0,0,0.7);
        }

        .ad-content-small {
            display: flex;
            padding: 10px;
            align-items: center;
        }

        .small-ad-image {
            width: 60px;
            height: 40px;
            object-fit: cover;
            border-radius: 5px;
            margin-right: 10px;
        }

        .small-ad-text {
            flex: 1;
        }

        .small-ad-text h5 {
            margin: 0 0 5px 0;
            font-size: 12px;
            color: #2c3e50;
            font-weight: 600;
        }

        .small-ad-text p {
            margin: 0 0 8px 0;
            font-size: 10px;
            color: #7f8c8d;
            line-height: 1.3;
        }

        .small-ad-button {
            background: #e74c3c;
            color: white;
            border: none;
            padding: 4px 12px;
            border-radius: 12px;
            font-size: 10px;
            cursor: pointer;
            transition: background 0.2s ease;
        }

        .small-ad-button:hover {
            background: #c0392b;
        }

        @keyframes slideInLeft {
            from {
                opacity: 0;
                transform: translateX(-100px);
            }
            to {
                opacity: 1;
                transform: translateX(0);
            }
        }

        /* アニメーション */
        @keyframes fadeInUp {
            from {
                opacity: 0;
                transform: translateY(20px);
            }
            to {
                opacity: 1;
                transform: translateY(0);
            }
        }

        /* レスポンシブ */
        @media (max-width: 1024px) {
            .left-sidebar {
                width: 250px;
            }
            .right-sidebar {
                width: 350px;
            }
        }

        @media (max-width: 768px) {
            .main-container {
                flex-direction: column;
            }
            
            .left-sidebar,
            .right-sidebar {
                width: 100%;
                height: 200px;
            }
            
            .map-container {
                flex: 1;
                min-height: 300px;
            }
        }
    </style>
</head>
<body>
    <!-- ヘッダー -->
    <div class="header">
        <div class="logo">🚲 PFC</div>
        <div class="header-subtitle">東京駐輪場検索システム</div>
    </div>

    <!-- メインコンテナ -->
    <div class="main-container chat-collapsed">
        <!-- 左サイドバー（エリア選択） -->
        <div class="left-sidebar">
            <div class="sidebar-header">
                <div class="sidebar-title">📍 エリア選択</div>
                <div class="sidebar-subtitle">地域を選択してください</div>
            </div>
            
            <div class="area-tabs">
                <!-- 主要駅周辺 -->
                <div class="tab-group">
                    <div class="tab-group-header" onclick="toggleTabGroup(this)">
                        🚉 主要駅周辺
                    </div>
                    <div class="tab-items">
                        <div class="tab-item" data-area="shinjuku">🏢 新宿駅周辺</div>
                        <div class="tab-item" data-area="shibuya">🎌 渋谷駅周辺</div>
                        <div class="tab-item" data-area="ikebukuro">🛍️ 池袋駅周辺</div>
                        <div class="tab-item" data-area="tokyo">🏯 東京駅周辺</div>
                        <div class="tab-item" data-area="shinagawa">🚅 品川駅周辺</div>
                        <div class="tab-item" data-area="ueno">🌸 上野駅周辺</div>
                    </div>
                </div>

                <!-- 23区 -->
                <div class="tab-group">
                    <div class="tab-group-header" onclick="toggleTabGroup(this)">
                        🏙️ 東京23区
                    </div>
                    <div class="tab-items">
                        <div class="tab-item" data-area="chiyoda">千代田区</div>
                        <div class="tab-item" data-area="chuo">中央区</div>
                        <div class="tab-item" data-area="minato">港区</div>
                        <div class="tab-item" data-area="shinjuku_ward">新宿区</div>
                        <div class="tab-item" data-area="bunkyo">文京区</div>
                        <div class="tab-item" data-area="taito">台東区</div>
                        <div class="tab-item" data-area="sumida">墨田区</div>
                        <div class="tab-item" data-area="koto">江東区</div>
                        <div class="tab-item" data-area="shinagawa_ward">品川区</div>
                        <div class="tab-item" data-area="meguro">目黒区</div>
                        <div class="tab-item" data-area="ota">大田区</div>
                        <div class="tab-item" data-area="setagaya">世田谷区</div>
                        <div class="tab-item" data-area="shibuya_ward">渋谷区</div>
                        <div class="tab-item" data-area="nakano">中野区</div>
                        <div class="tab-item" data-area="suginami">杉並区</div>
                        <div class="tab-item" data-area="toshima">豊島区</div>
                        <div class="tab-item" data-area="kita">北区</div>
                        <div class="tab-item" data-area="arakawa">荒川区</div>
                        <div class="tab-item" data-area="itabashi">板橋区</div>
                        <div class="tab-item" data-area="nerima">練馬区</div>
                        <div class="tab-item" data-area="adachi">足立区</div>
                        <div class="tab-item" data-area="katsushika">葛飾区</div>
                        <div class="tab-item" data-area="edogawa">江戸川区</div>
                    </div>
                </div>

                <!-- 多摩地域 -->
                <div class="tab-group">
                    <div class="tab-group-header" onclick="toggleTabGroup(this)">
                        🌲 多摩地域
                    </div>
                    <div class="tab-items">
                        <div class="tab-item" data-area="hachioji">八王子市</div>
                        <div class="tab-item" data-area="tachikawa">立川市</div>
                        <div class="tab-item" data-area="musashino">武蔵野市</div>
                        <div class="tab-item" data-area="mitaka">三鷹市</div>
                        <div class="tab-item" data-area="machida">町田市</div>
                    </div>
                </div>
            </div>
        </div>

        <!-- 中央マップエリア -->
        <div class="map-container">
            <div id="map"></div>
            <div class="map-controls">
                <div class="current-area" id="currentArea">エリアを選択してください</div>
                <div class="area-info" id="areaInfo">左のタブからエリアを選択</div>
            </div>
        </div>

        <!-- 右サイドバー（チャット） -->
        <div class="right-sidebar collapsed" id="rightSidebar">
            <button class="sidebar-toggle" id="sidebarToggle" onclick="toggleSidebar()" title="チャットを開く/閉じる">
                <span class="sidebar-toggle-icon">💬 チャットで質問</span>
            </button>
            
            <div class="chat-header">
                <div class="chat-title">💬 駐輪場チャット</div>
                <div class="chat-subtitle">質問や検索ができます</div>
            </div>
            
            <div class="chat-tabs" id="chatTabs">
                <div class="chat-tab active" id="tab-1" onclick="switchChatTab(1)">
                    <span>💬 検索チャット</span>
                    <button class="tab-close" onclick="event.stopPropagation(); confirmCloseChatTab(1)" title="タブを閉じる">×</button>
                </div>
                <div class="new-chat-tab" onclick="createNewChatTab()" title="新しいタブを作成">+</div>
            </div>
            
            <div class="chat-messages" id="chatMessages-1">
                <div class="message bot">
                    <div class="message-content">
                        こんにちは！東京の駐輪場をお探しですね 🚲<br>
                        まず、どちらの方法で探しますか？
                        <div class="chat-options">
                            <div class="option-button" onclick="selectSearchMethod('destination')">
                                📍 目的地から駐輪場を探す
                            </div>
                            <div class="option-button" onclick="selectSearchMethod('area')">
                                🗺️ エリアから駐輪場を探す
                            </div>
                            <div class="option-button" onclick="selectSearchMethod('condition')">
                                ⚙️ 条件から駐輪場を探す
                            </div>
                        </div>
                    </div>
                </div>
            </div>
            
            <div class="chat-input">
                <div class="input-container">
                    <input type="text" class="message-input" id="messageInput" placeholder="駐輪場について質問してください...">
                    <button class="send-button" onclick="sendMessage()">送信</button>
                </div>
            </div>
        </div>
    </div>

    <!-- 左下固定広告エリア -->
    <div class="bottom-left-ad">
        <div class="ad-close" onclick="closeBottomAd()">&times;</div>
        <div class="ad-content-small">
            <img src="https://via.placeholder.com/200x100/e74c3c/ffffff?text=自転車保険" alt="自転車保険" class="small-ad-image">
            <div class="small-ad-text">
                <h5>駐輪場利用者必見！</h5>
                <p>自転車保険で安心・安全</p>
                <button class="small-ad-button" onclick="handleBottomAdClick()">詳細</button>
            </div>
        </div>
    </div>

    <script src="https://unpkg.com/leaflet@1.9.4/dist/leaflet.js"></script>
    <script>
        // グローバル変数
        let map;
        let currentArea = null;
        let markers = [];
        let currentChatTab = 1;
        let chatTabCounter = 1;
        let chatTabs = {
            1: {
                id: 1,
                title: '💬 検索チャット',
                messages: [],
                state: {
                    step: 'initial',
                    method: null,
                    destination: null,
                    priority: null,
                    selectedOptions: {}
                }
            }
        };

        // エリアデータ
        const areaData = {
            'shinjuku': { name: '新宿駅周辺', ward: '新宿区', coordinates: [35.6896, 139.7006] },
            'shibuya': { name: '渋谷駅周辺', ward: '渋谷区', coordinates: [35.6598, 139.7006] },
            'ikebukuro': { name: '池袋駅周辺', ward: '豊島区', coordinates: [35.7295, 139.7109] },
            'tokyo': { name: '東京駅周辺', ward: '千代田区', coordinates: [35.6812, 139.7671] },
            'shinagawa': { name: '品川駅周辺', ward: '港区', coordinates: [35.6284, 139.7387] },
            'ueno': { name: '上野駅周辺', ward: '台東区', coordinates: [35.7140, 139.7774] },
            'chiyoda': { name: '千代田区', ward: '千代田区', coordinates: [35.6939, 139.7535] },
            'chuo': { name: '中央区', ward: '中央区', coordinates: [35.6735, 139.7712] },
            'minato': { name: '港区', ward: '港区', coordinates: [35.6581, 139.7414] },
            'shinjuku_ward': { name: '新宿区', ward: '新宿区', coordinates: [35.6896, 139.7006] },
            'bunkyo': { name: '文京区', ward: '文京区', coordinates: [35.7083, 139.7516] },
            'taito': { name: '台東区', ward: '台東区', coordinates: [35.7120, 139.7795] },
            'sumida': { name: '墨田区', ward: '墨田区', coordinates: [35.7100, 139.8017] },
            'koto': { name: '江東区', ward: '江東区', coordinates: [35.6727, 139.8169] },
            'shinagawa_ward': { name: '品川区', ward: '品川区', coordinates: [35.6284, 139.7387] },
            'meguro': { name: '目黒区', ward: '目黒区', coordinates: [35.6439, 139.7157] },
            'ota': { name: '大田区', ward: '大田区', coordinates: [35.5613, 139.7164] },
            'setagaya': { name: '世田谷区', ward: '世田谷区', coordinates: [35.6464, 139.6534] },
            'shibuya_ward': { name: '渋谷区', ward: '渋谷区', coordinates: [35.6598, 139.7006] },
            'nakano': { name: '中野区', ward: '中野区', coordinates: [35.7055, 139.6653] },
            'suginami': { name: '杉並区', ward: '杉並区', coordinates: [35.6998, 139.6363] },
            'toshima': { name: '豊島区', ward: '豊島区', coordinates: [35.7295, 139.7109] },
            'kita': { name: '北区', ward: '北区', coordinates: [35.7539, 139.7340] },
            'arakawa': { name: '荒川区', ward: '荒川区', coordinates: [35.7364, 139.7834] },
            'itabashi': { name: '板橋区', ward: '板橋区', coordinates: [35.7505, 139.7089] },
            'nerima': { name: '練馬区', ward: '練馬区', coordinates: [35.7353, 139.6532] },
            'adachi': { name: '足立区', ward: '足立区', coordinates: [35.7751, 139.8048] },
            'katsushika': { name: '葛飾区', ward: '葛飾区', coordinates: [35.7436, 139.8485] },
            'edogawa': { name: '江戸川区', ward: '江戸川区', coordinates: [35.7069, 139.8683] },
            'hachioji': { name: '八王子市', ward: '八王子市', coordinates: [35.6560, 139.3439] },
            'tachikawa': { name: '立川市', ward: '立川市', coordinates: [35.7022, 139.4138] },
            'musashino': { name: '武蔵野市', ward: '武蔵野市', coordinates: [35.7178, 139.5640] },
            'mitaka': { name: '三鷹市', ward: '三鷹市', coordinates: [35.6837, 139.5596] },
            'machida': { name: '町田市', ward: '町田市', coordinates: [35.5439, 139.4269] }
        };

        // サイドバー表示切り替え
        function toggleSidebar() {
            const sidebar = document.getElementById('rightSidebar');
            const toggle = document.getElementById('sidebarToggle');
            const mainContainer = document.querySelector('.main-container');
            
            if (sidebar.classList.contains('collapsed')) {
                sidebar.classList.remove('collapsed');
                mainContainer.classList.remove('chat-collapsed');
                toggle.innerHTML = '<span class="sidebar-toggle-icon">◀</span>';
            } else {
                sidebar.classList.add('collapsed');
                mainContainer.classList.add('chat-collapsed');
                toggle.innerHTML = '<span class="sidebar-toggle-icon">💬 チャットで質問</span>';
            }
        }

        // 新しいタブ作成
        function createNewChatTab() {
            chatTabCounter++;
            const newTabId = chatTabCounter;
            
            // 新しいタブデータ
            chatTabs[newTabId] = {
                id: newTabId,
                title: `💬 質問 ${newTabId}`,
                messages: [],
                state: {
                    step: 'initial',
                    method: null,
                    destination: null,
                    priority: null,
                    selectedOptions: {}
                }
            };
            
            // タブUIを追加
            const tabsContainer = document.getElementById('chatTabs');
            const newChatTab = tabsContainer.querySelector('.new-chat-tab');
            
            const tabElement = document.createElement('div');
            tabElement.className = 'chat-tab';
            tabElement.id = `tab-${newTabId}`;
            tabElement.onclick = () => switchChatTab(newTabId);
            tabElement.innerHTML = `
                <span>${chatTabs[newTabId].title}</span>
                <button class="tab-close" onclick="event.stopPropagation(); confirmCloseChatTab(${newTabId})" title="タブを閉じる">×</button>
            `;
            
            tabsContainer.insertBefore(tabElement, newChatTab);
            
            // メッセージエリアを作成
            const chatContainer = document.querySelector('.right-sidebar');
            const messagesContainer = document.createElement('div');
            messagesContainer.className = 'chat-messages';
            messagesContainer.id = `chatMessages-${newTabId}`;
            messagesContainer.style.display = 'none';
            messagesContainer.innerHTML = `
                <div class="message bot">
                    <div class="message-content">
                        こんにちは！東京の駐輪場をお探しですね 🚲<br>
                        まず、どちらの方法で探しますか？
                        <div class="chat-options">
                            <div class="option-button" onclick="selectSearchMethod('destination')">
                                📍 目的地から駐輪場を探す
                            </div>
                            <div class="option-button" onclick="selectSearchMethod('area')">
                                🗺️ エリアから駐輪場を探す
                            </div>
                            <div class="option-button" onclick="selectSearchMethod('condition')">
                                ⚙️ 条件から駐輪場を探す
                            </div>
                        </div>
                    </div>
                </div>
            `;
            
            const chatInput = chatContainer.querySelector('.chat-input');
            chatContainer.insertBefore(messagesContainer, chatInput);
            
            // 新しいタブに切り替え
            switchChatTab(newTabId);
            
            // 成功通知
            showNotification(`新しいタブ「${chatTabs[newTabId].title}」を作成しました`, 'success');
        }

        // タブ切り替え
        function switchChatTab(tabId) {
            // 前のタブを非アクティブに
            document.querySelectorAll('.chat-tab').forEach(tab => {
                tab.classList.remove('active');
            });
            document.querySelectorAll('.chat-messages').forEach(messages => {
                messages.style.display = 'none';
            });
            
            // 新しいタブをアクティブに
            document.getElementById(`tab-${tabId}`).classList.add('active');
            document.getElementById(`chatMessages-${tabId}`).style.display = 'block';
            
            currentChatTab = tabId;
        }

        // タブ削除確認
        function confirmCloseChatTab(tabId) {
            const tabCount = Object.keys(chatTabs).length;
            
            if (tabCount <= 1) {
                showNotification('最低1つのタブは必要です', 'warning');
                return;
            }
            
            closeChatTab(tabId);
        }

        // タブを閉じる（アニメーション付き）
        function closeChatTab(tabId) {
            const tabElement = document.getElementById(`tab-${tabId}`);
            const messagesElement = document.getElementById(`chatMessages-${tabId}`);
            
            // 削除アニメーション開始
            tabElement.classList.add('tab-removing');
            
            // アニメーション完了後に削除
            setTimeout(() => {
                // タブデータ削除
                delete chatTabs[tabId];
                
                // UI削除
                tabElement.remove();
                messagesElement.remove();
                
                // アクティブタブが削除された場合、他のタブに切り替え
                if (currentChatTab === tabId) {
                    const remainingTabIds = Object.keys(chatTabs).map(id => parseInt(id));
                    const remainingTabId = remainingTabIds[0];
                    switchChatTab(remainingTabId);
                }
                
                showNotification('タブを閉じました', 'success');
            }, 300);
        }

        // 通知表示
        function showNotification(message, type = 'info') {
            const notification = document.createElement('div');
            const colors = {
                success: '#27ae60',
                warning: '#f39c12',
                error: '#e74c3c',
                info: '#3498db'
            };
            
            notification.style.cssText = `
                position: fixed;
                top: 80px;
                right: 20px;
                background: ${colors[type]};
                color: white;
                padding: 12px 20px;
                border-radius: 8px;
                font-size: 14px;
                z-index: 10000;
                box-shadow: 0 4px 12px rgba(0,0,0,0.2);
                animation: slideInRight 0.3s ease-out;
            `;
            notification.textContent = message;
            
            // アニメーションCSS追加
            if (!document.getElementById('notification-animations')) {
                const style = document.createElement('style');
                style.id = 'notification-animations';
                style.textContent = `
                    @keyframes slideInRight {
                        from {
                            opacity: 0;
                            transform: translateX(100px);
                        }
                        to {
                            opacity: 1;
                            transform: translateX(0);
                        }
                    }
                `;
                document.head.appendChild(style);
            }
            
            document.body.appendChild(notification);
            
            // 3秒後に削除
            setTimeout(() => {
                notification.style.animation = 'slideInRight 0.3s ease-out reverse';
                setTimeout(() => notification.remove(), 300);
            }, 3000);
        }

        // 地図初期化
        function initMap() {
            map = L.map('map').setView([35.6762, 139.6503], 11);
            
            L.tileLayer('https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png', {
                attribution: '© OpenStreetMap contributors'
            }).addTo(map);
        }

        // タブグループの開閉
        function toggleTabGroup(header) {
            const tabItems = header.nextElementSibling;
            const isActive = tabItems.classList.contains('active');
            
            // すべてのタブを閉じる
            document.querySelectorAll('.tab-items').forEach(items => {
                items.classList.remove('active');
            });
            
            // クリックされたタブを開く（すでに開いていた場合は閉じる）
            if (!isActive) {
                tabItems.classList.add('active');
            }
        }

        // エリア選択
        function selectArea(areaId) {
            console.log('エリア選択:', areaId);
            
            if (!areaData[areaId]) {
                console.error('無効なエリア:', areaId);
                return;
            }

            const area = areaData[areaId];
            currentArea = areaId;

            // 前の選択を解除
            document.querySelectorAll('.tab-item').forEach(item => {
                item.classList.remove('selected');
            });

            // 新しい選択をハイライト
            document.querySelector(`[data-area="${areaId}"]`).classList.add('selected');

            // マップ移動
            if (map) {
                map.setView(area.coordinates, 15);
            }

            // コントロール更新
            document.getElementById('currentArea').textContent = area.name;
            document.getElementById('areaInfo').textContent = `${area.ward} を表示中`;

            // 駐輪場データ生成（モック）
            generateMockParkingData(area);

            // チャットに結果表示（エリア選択時は履歴に残さない）
            const currentState = chatTabs[currentChatTab].state;
            if (currentState.method === 'area') {
                // エリア選択モードの場合は履歴に残さず、マップ情報のみ更新
                currentState.method = null; // リセット
            } else if (currentState.method === 'destination') {
                // 目的地検索モード - チャット履歴に追加
                addBotMessage(`${area.name}周辺の駐輪場を表示しました 📍`, generateMockParkingList(area));
            } else {
                // 直接タブクリック - 通知メッセージのみ（詳細な履歴は不要）
                showMapNotification(`${area.name}の駐輪場情報を表示中`);
            }
        }

        // カスタムマーカーアイコンを作成
        function createCustomIcon(available) {
            let color, textColor;
            
            if (available <= 5) {
                color = '#e74c3c'; // 赤
                textColor = 'white';
            } else if (available <= 15) {
                color = '#f39c12'; // 黄色
                textColor = 'white';
            } else {
                color = '#27ae60'; // 緑
                textColor = 'white';
            }
            
            return L.divIcon({
                className: 'custom-div-icon',
                html: `
                    <div style="
                        background-color: ${color};
                        width: 30px;
                        height: 30px;
                        border-radius: 50% 50% 50% 0;
                        border: 2px solid white;
                        transform: rotate(-45deg);
                        display: flex;
                        align-items: center;
                        justify-content: center;
                        box-shadow: 0 2px 5px rgba(0,0,0,0.3);
                    ">
                        <span style="
                            color: ${textColor};
                            font-size: 10px;
                            font-weight: bold;
                            transform: rotate(45deg);
                        ">${available}</span>
                    </div>
                `,
                iconSize: [30, 30],
                iconAnchor: [15, 30]
            });
        }

        // モック駐輪場データ生成
        function generateMockParkingData(area) {
            // 既存のマーカーを削除
            markers.forEach(marker => map.removeLayer(marker));
            markers = [];

            const parkingNames = ['駅前駐輪場', '市営駐輪場', '商業施設駐輪場', '公園駐輪場', '病院駐輪場'];
            
            for (let i = 0; i < 5; i++) {
                const lat = area.coordinates[0] + (Math.random() - 0.5) * 0.01;
                const lng = area.coordinates[1] + (Math.random() - 0.5) * 0.01;
                const available = Math.floor(Math.random() * 50) + 1; // 1-50の空き台数
                const total = Math.floor(Math.random() * 20) + 80;
                const fee = (Math.floor(Math.random() * 5) + 1) * 100;
                
                const customIcon = createCustomIcon(available);
                
                const marker = L.marker([lat, lng], { icon: customIcon }).addTo(map)
                    .bindPopup(`
                        <div>
                            <h4>${area.ward}${parkingNames[i]}</h4>
                            <p style="color: ${available <= 5 ? '#e74c3c' : available <= 15 ? '#f39c12' : '#27ae60'}; font-weight: bold;">
                                空き: ${available}/${total}台
                            </p>
                            <p>料金: ${fee}円/日</p>
                            <p>営業: 24時間</p>
                        </div>
                    `);
                
                markers.push(marker);
            }
        }

        // モック駐輪場リスト生成
        function generateMockParkingList(area) {
            const parkingNames = ['駅前駐輪場', '市営駐輪場', '商業施設駐輪場', '公園駐輪場', '病院駐輪場'];
            let html = '<div class="parking-list">';
            
            for (let i = 0; i < 5; i++) {
                const available = Math.floor(Math.random() * 50) + 10;
                const total = Math.floor(Math.random() * 20) + 80;
                const fee = (Math.floor(Math.random() * 5) + 1) * 100;
                
                html += `
                    <div class="parking-card">
                        <div class="parking-name">${area.ward}${parkingNames[i]}</div>
                        <div class="parking-info">
                            <span>空き: ${available}/${total}台</span>
                            <span>${fee}円/日</span>
                        </div>
                    </div>
                `;
            }
            
            html += '</div>';
            return html;
        }

        // マップ通知表示
        function showMapNotification(message) {
            const notification = document.createElement('div');
            notification.style.cssText = `
                position: absolute;
                top: 80px;
                right: 20px;
                background: #27ae60;
                color: white;
                padding: 10px 15px;
                border-radius: 8px;
                font-size: 14px;
                z-index: 1000;
                animation: fadeInOut 3s ease-in-out;
            `;
            notification.textContent = message;
            
            // アニメーションのCSSを追加
            if (!document.getElementById('notification-style')) {
                const style = document.createElement('style');
                style.id = 'notification-style';
                style.textContent = `
                    @keyframes fadeInOut {
                        0% { opacity: 0; transform: translateY(-10px); }
                        20%, 80% { opacity: 1; transform: translateY(0); }
                        100% { opacity: 0; transform: translateY(-10px); }
                    }
                `;
                document.head.appendChild(style);
            }
            
            document.querySelector('.map-container').appendChild(notification);
            
            // 3秒後に削除
            setTimeout(() => {
                notification.remove();
            }, 3000);
        }

        // チャット状態リセット
        function resetChatState() {
            chatTabs[currentChatTab].state = {
                step: 'initial',
                method: null,
                destination: null,
                priority: null,
                selectedOptions: {}
            };
        }

        // チャットメッセージ追加
        function addBotMessage(text, html = '') {
            const chatMessages = document.getElementById(`chatMessages-${currentChatTab}`);
            const messageDiv = document.createElement('div');
            messageDiv.className = 'message bot';
            messageDiv.innerHTML = `
                <div class="message-content">
                    ${text}
                    ${html}
                    ${html ? '<div style="margin-top: 10px;"><button class="confirm-button" onclick="showNewSearchOptions()">別の検索をする</button></div>' : ''}
                </div>
            `;
            chatMessages.appendChild(messageDiv);
            chatMessages.scrollTop = chatMessages.scrollHeight;
        }

        // 新しい検索オプションを表示
        function showNewSearchOptions() {
            resetChatState();
            const html = `
                他の駐輪場も探してみますか？ 🔍
                <div class="chat-options">
                    <div class="option-button" onclick="selectSearchMethod('destination')">
                        📍 目的地から駐輪場を探す
                    </div>
                    <div class="option-button" onclick="selectSearchMethod('area')">
                        🗺️ エリアから駐輪場を探す
                    </div>
                    <div class="option-button" onclick="selectSearchMethod('condition')">
                        ⚙️ 条件から駐輪場を探す
                    </div>
                </div>
            `;
            addBotMessage(html);
        }

        function addUserMessage(text) {
            const chatMessages = document.getElementById(`chatMessages-${currentChatTab}`);
            const messageDiv = document.createElement('div');
            messageDiv.className = 'message user';
            messageDiv.innerHTML = `
                <div class="message-content">${text}</div>
            `;
            chatMessages.appendChild(messageDiv);
            chatMessages.scrollTop = chatMessages.scrollHeight;
        }

        // 検索方法選択
        function selectSearchMethod(method) {
            const currentState = chatTabs[currentChatTab].state;
            currentState.method = method;
            currentState.step = 'method_selected';
            
            // 選択されたボタンをハイライト
            document.querySelectorAll('.option-button').forEach(btn => {
                btn.classList.remove('selected');
            });
            event.target.classList.add('selected');
            
            setTimeout(() => {
                if (method === 'destination') {
                    showDestinationInput();
                } else if (method === 'area') {
                    showAreaSelectionMessage();
                } else if (method === 'condition') {
                    showConditionOptions();
                }
            }, 500);
        }

        // 目的地入力を表示
        function showDestinationInput() {
            const html = `
                目的地を教えてください 📍<br>
                駅名、施設名、住所などを入力してください。
                <input type="text" class="destination-input" id="destinationInput" placeholder="例：新宿駅、東京スカイツリー、渋谷109">
                <button class="confirm-button" onclick="confirmDestination()">この目的地で検索</button>
            `;
            addBotMessage(html);
        }

        // エリア選択メッセージ
        function showAreaSelectionMessage() {
            chatTabs[currentChatTab].state.method = 'area';
            addBotMessage('左のエリアタブから地域を選択してください 🗺️<br>選択すると、その地域の駐輪場一覧が表示されます。');
        }

        // 条件選択を表示
        function showConditionOptions() {
            const html = `
                どのような条件でお探しですか？ ⚙️
                <div class="chat-options">
                    <div class="option-button" onclick="selectCondition('price')">
                        💰 料金が安い駐輪場
                    </div>
                    <div class="option-button" onclick="selectCondition('availability')">
                        🚲 空きが多い駐輪場
                    </div>
                    <div class="option-button" onclick="selectCondition('24hours')">
                        🌙 24時間営業の駐輪場
                    </div>
                    <div class="option-button" onclick="selectCondition('station')">
                        🚉 駅から近い駐輪場
                    </div>
                </div>
            `;
            addBotMessage(html);
        }

        // 目的地確定
        function confirmDestination() {
            const input = document.getElementById('destinationInput');
            const destination = input.value.trim();
            
            if (!destination) {
                alert('目的地を入力してください');
                return;
            }
            
            chatTabs[currentChatTab].state.destination = destination;
            addUserMessage(destination);
            
            // 目的地から最適なエリアを推定
            const estimatedArea = estimateAreaFromDestination(destination);
            if (estimatedArea) {
                selectArea(estimatedArea);
            }
            
            // 優先順位を聞く
            setTimeout(() => {
                showPriorityOptions(destination);
            }, 1000);
        }

        // 目的地からエリアを推定
        function estimateAreaFromDestination(destination) {
            const dest = destination.toLowerCase();
            
            if (dest.includes('新宿') || dest.includes('shinjuku')) return 'shinjuku';
            if (dest.includes('渋谷') || dest.includes('shibuya')) return 'shibuya';
            if (dest.includes('池袋') || dest.includes('ikebukuro')) return 'ikebukuro';
            if (dest.includes('東京駅') || dest.includes('tokyo')) return 'tokyo';
            if (dest.includes('品川') || dest.includes('shinagawa')) return 'shinagawa';
            if (dest.includes('上野') || dest.includes('ueno')) return 'ueno';
            
            // デフォルトは池袋
            return 'ikebukuro';
        }

        // 優先順位選択を表示
        function showPriorityOptions(destination) {
            const html = `
                「${destination}」周辺の駐輪場ですね！<br>
                何を重視して選びますか？ 🤔
                <div class="chat-options">
                    <div class="option-button" onclick="selectPriority('distance')">
                        🚶 目的地からの距離
                    </div>
                    <div class="option-button" onclick="selectPriority('price')">
                        💰 料金の安さ
                    </div>
                    <div class="option-button" onclick="selectPriority('availability')">
                        🚲 空きの多さ
                    </div>
                    <div class="option-button" onclick="selectPriority('hours')">
                        🕐 営業時間の長さ
                    </div>
                </div>
            `;
            addBotMessage(html);
        }

        // 優先順位選択
        function selectPriority(priority) {
            chatTabs[currentChatTab].state.priority = priority;
            
            // 選択をハイライト
            document.querySelectorAll('.option-button').forEach(btn => {
                btn.classList.remove('selected');
            });
            event.target.classList.add('selected');
            
            const priorityNames = {
                'distance': '距離重視',
                'price': '料金重視',
                'availability': '空き状況重視',
                'hours': '営業時間重視'
            };
            
            setTimeout(() => {
                const resultHtml = generatePrioritizedParkingList(chatTabs[currentChatTab].state.destination, priority);
                addBotMessage(`${priorityNames[priority]}で検索しました！ 🎯`, resultHtml);
            }, 800);
        }

        // 条件選択
        function selectCondition(condition) {
            chatTabs[currentChatTab].state.priority = condition;
            
            // 選択をハイライト
            document.querySelectorAll('.option-button').forEach(btn => {
                btn.classList.remove('selected');
            });
            event.target.classList.add('selected');
            
            setTimeout(() => {
                const resultHtml = generateConditionBasedParkingList(condition);
                addBotMessage(`条件に合う駐輪場を見つけました！ ✨`, resultHtml);
            }, 800);
        }

        // 優先順位に基づく駐輪場リスト生成
        function generatePrioritizedParkingList(destination, priority) {
            const parkingData = [
                { name: `${destination}駅前駐輪場`, distance: '徒歩1分', price: 200, availability: 45, hours: '24時間' },
                { name: `${destination}市営駐輪場`, distance: '徒歩3分', price: 100, availability: 23, hours: '6:00-22:00' },
                { name: `${destination}商業施設駐輪場`, distance: '徒歩5分', price: 300, availability: 67, hours: '24時間' },
                { name: `${destination}公園駐輪場`, distance: '徒歩7分', price: 150, availability: 89, hours: '5:00-23:00' }
            ];

            // 優先順位に基づいてソート
            if (priority === 'distance') {
                parkingData.sort((a, b) => parseInt(a.distance) - parseInt(b.distance));
            } else if (priority === 'price') {
                parkingData.sort((a, b) => a.price - b.price);
            } else if (priority === 'availability') {
                parkingData.sort((a, b) => b.availability - a.availability);
            }

            let html = '<div class="parking-list">';
            parkingData.forEach((parking, index) => {
                const tag = index === 0 ? `<span class="priority-tag ${priority}">おすすめ</span>` : '';
                html += `
                    <div class="parking-card">
                        <div class="parking-name">${parking.name}${tag}</div>
                        <div class="parking-info">
                            <span>${parking.distance} | 空き: ${parking.availability}台</span>
                            <span>${parking.price}円/日</span>
                        </div>
                    </div>
                `;
            });
            html += '</div>';
            return html;
        }

        // 条件に基づく駐輪場リスト生成
        function generateConditionBasedParkingList(condition) {
            let html = '<div class="parking-list">';
            
            if (condition === 'price') {
                const cheapParkings = [
                    { name: '市営第一駐輪場', price: 50, info: '徒歩5分' },
                    { name: '区営駐輪場', price: 80, info: '徒歩3分' },
                    { name: '商店街駐輪場', price: 100, info: '徒歩2分' }
                ];
                cheapParkings.forEach(parking => {
                    html += `
                        <div class="parking-card">
                            <div class="parking-name">${parking.name}<span class="priority-tag price">激安</span></div>
                            <div class="parking-info">
                                <span>${parking.info}</span>
                                <span>${parking.price}円/日</span>
                            </div>
                        </div>
                    `;
                });
            } else if (condition === '24hours') {
                const allDayParkings = [
                    { name: '24時間駅前駐輪場', info: '徒歩1分 | 空き: 34台' },
                    { name: 'コンビニ併設駐輪場', info: '徒歩4分 | 空き: 12台' },
                    { name: '24時間商業施設駐輪場', info: '徒歩6分 | 空き: 56台' }
                ];
                allDayParkings.forEach(parking => {
                    html += `
                        <div class="parking-card">
                            <div class="parking-name">${parking.name}<span class="priority-tag">24H</span></div>
                            <div class="parking-info">
                                <span>${parking.info}</span>
                                <span>200円/日</span>
                            </div>
                        </div>
                    `;
                });
            }
            
            html += '</div>';
            return html;
        }

        // メッセージ送信（フリー入力）
        function sendMessage() {
            const input = document.getElementById('messageInput');
            const message = input.value.trim();
            
            if (!message) return;
            
            addUserMessage(message);
            input.value = '';
            
            // 簡単な応答ロジック
            setTimeout(() => {
                if (message.includes('空き') || message.includes('available')) {
                    showConditionOptions();
                } else if (message.includes('料金') || message.includes('安い')) {
                    selectCondition('price');
                } else if (message.includes('24時間') || message.includes('深夜')) {
                    selectCondition('24hours');
                } else {
                    addBotMessage('ご質問ありがとうございます！上の選択肢から検索方法を選んでいただくか、具体的な目的地や条件を教えてください。');
                }
            }, 500);
        }

        // 左下広告関連の関数
        function closeBottomAd() {
            const ad = document.querySelector('.bottom-left-ad');
            ad.style.animation = 'slideOutLeft 0.3s ease-in';
            setTimeout(() => {
                ad.style.display = 'none';
            }, 300);
        }

        function handleBottomAdClick() {
            console.log('左下広告クリック - アフィリエイトリンクへ遷移');
            // window.open('https://affiliate-link.com', '_blank');
        }

        // slideOutLeft アニメーションを追加
        const adStyle = document.createElement('style');
        adStyle.textContent = `
            @keyframes slideOutLeft {
                from {
                    opacity: 1;
                    transform: translateX(0);
                }
                to {
                    opacity: 0;
                    transform: translateX(-100px);
                }
            }
        `;
        document.head.appendChild(adStyle);

        // イベントリスナー設定
        document.addEventListener('DOMContentLoaded', function() {
            // 地図初期化
            initMap();
            
            // タブアイテムクリックイベント
            document.querySelectorAll('.tab-item').forEach(item => {
                item.addEventListener('click', function() {
                    const areaId = this.getAttribute('data-area');
                    selectArea(areaId);
                });
            });
            
            // Enterキーでメッセージ送信
            document.getElementById('messageInput').addEventListener('keypress', function(e) {
                if (e.key === 'Enter') {
                    sendMessage();
                }
            });
            
        });
    </script>
</body>
</html>